---
9Mayout: post
title: 软件无线电学习（三）pluto-FM recv gnuradio
data: 2022-7-1
description: "软件无线电学习"
tag: 软件无线电
typora-root-url: ..
---

今天，主要使用pluto的那一套配合gnuradio完成了一个FM广播的接收。突然打开了新世界，对通信越来越感兴趣。而gnuradio的模块化更是提供了一个很好的学习平台，搞清楚每个模块的作用就可以弄清楚FM通信的流程。

## FM介绍
FM其实是调频，也就是“频率调制”。使载波的瞬时频率按照所需传递信号的变化规律而变化的调制方法。它是一种使受调波瞬时频率随调制信号而变的调制方法。实现这种调制方法的电路称调频器，一般广泛用于调频广播，电视伴音，微波通信，锁相电路和扫频仪等方面。由调频方法产生的无线电波叫做调频波，其基本特征是载波的振荡幅度保持不变，振荡频率随调制信号而变。调频（FM），就是高频载波的频率不是一个常数，是随调制信号而在一定范围内变化的调制方式，其幅值则是一个常数。与其对应的，调幅就是载频的频率是不变的，其幅值随调制信号而变。



### 频率调制

频率调制就是需要用载波的频率大小来表示基带信号幅度的大小。比如在下面的这副图就可以看见，我们想要实现得到一个已调波，基带信号幅度上升时，已调波频率增加，基带信号幅度下降时，已调波频率渐少。

![img](https://images.cnblogs.com/cnblogs_com/gjblog/1826807/o_200812095551Amfm3-en-de.gif)

### 原理与实现

首先我们要做到的是用基带信号的幅度来控制已调波的频率，首先我们假设基带信号为m(t)，载波频率为fc，载波振幅为Ac。倒着推：直接假设已调波S~FM~(t)如下：

![image-20220718143416209](/images/SDR/image-20220718143416209.png)

瞬时频率为：

![image-20220718143917113](/images/SDR/image-20220718143917113.png)

瞬时频偏：

![image-20220718143936993](/images/SDR/image-20220718143936993.png)

这样瞬时偏频和信号的幅度就可以有一个关系，假设下面关系式：

![image-20220718144343964](/images/SDR/image-20220718144343964.png)

其中K~f~为偏频常数，表示调频器的调频灵敏度。整理公式2和公式1就可以得到真正的表达式：

![image-20220718144121438](/images/SDR/image-20220718144121438.png)

更近一步，假设基带信号为余弦波![image-20220718144253040](/images/SDR/image-20220718144253040.png)，已调频的表达式为:

![image-20220718105543171](/images/SDR/image-20220718105543171.png)

![image-20220718105316644](/images/SDR/image-20220718105316644.png)

这样就顺利推导出了已调波的表达式，调制部分基本就是这么多。

#### Matlab仿真

```matlab
Fs = 2000;	%采样频率
Ts = 1 / Fs;
L = 2000; %采样点
t = (0 : L-1)*Ts;

kf = 45; %调频灵敏度
fm = 4;	%基带信号频率
fc = 50;%载波频率
mt = cos(2 * pi *fm *t);%基带信号
st = cos(2 * pi *fc *t + kf* sin(2 * pi * fm * t) / fm); %公式4得到的已调FM信号
```

运行代码可以看见：

![image-20220718141942643](/images/SDR/image-20220718141942643.png)

![image-20220718141951670](/images/SDR/image-20220718141951670.png)

### 解调

基带信号调制完毕后，在不考虑噪声的问题，需要从已调信号恢复我们想要的基带信号。首先这里可以用一中非相干解调的方法，也就是说，我们不用把已调信号和本地载波相乘的操作，也不用使用锁相环。但我们需要对已调信号做微分和使用一点点希尔伯特变换相关的知识。

首先我们需要从已调信号中恢复m(t)来，对公式（3）的S~FM~(t)求微分，得到：

![image-20220718160533185](/images/SDR/image-20220718160533185.png)

一般假设Ac=1，那也就说，如果我们能将S~d~(t)的包络![image-20220718111331399](/images/SDR/image-20220718111331399.png)通过某种方式提取出来，那么我们就能恢复m(t)，那么接下来我们就要用希尔伯特变换和解析信号的性质来提取包络。

![image-20220718171807567](/images/SDR/image-20220718171807567.png)

可以看见包络信号和基带信号很像，只是振幅小了一些，增加了一些直流分量而已。

#### 希尔伯特变换（包络检波原理）



## Gnuradio FM流程

这里用gnuradio接收FM广播信息，首先从每个模块分析入手。

![image-20220718113139213](/images/SDR/image-20220718113139213.png)

整个流程图框架主要有这几个框架：

- **PlutoSDR Source:**Pluto的信号源，也就是收通道，这里要注意几个参数
  - **LO Frequency:**
  - **Sample Rate:**
  - **RF Bandwidth:**
  - **Buffer size:**
  - 
- **Rational Resamplter:**
- **WBFM Receive:**
- **Rational resampler:**
- **Multiply Const:**
- **Audio Sink:**